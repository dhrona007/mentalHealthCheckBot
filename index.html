<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mentalyze - Mental Health Assistant</title>
    <link rel="stylesheet" href="/static/css/main.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&family=Rouge+Script&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <script>
        const BACKEND_URL = '';
    </script>
    <script type="module" src="/static/js/app.js" defer></script>
    <link rel="icon" type="image/png" href="/static/images/LogoBalckVersion.png" />
</head>

<body class="m-auto pt-sans-regular">
    <div class="container-fluid">
        <!-- <h1></h1> -->
        <nav class="navbar  border-body mt-5 m-auto" data-bs-theme="dark">
            <div class="container-fluid">
                <a class="navbar-brand text-black font-italic" href="#home">
                    <div class="logoBrand sticky-top fixed-top">
                        <!-- <img src="./static/images/LogoBalckVersion.png" height="50px"> -->
                        <h1 class="rouge-script-regular">Mentalyze</h1>
                    </div>
                </a>
                <button class="navbar-toggler bg-dark" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="true"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse ml-auto " id="navbarTogglerDemo01">
                    <!-- <a class="navbar-brand" href="#">Hidden brand</a> -->
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="#home">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#assessment">Assessment</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chat">Chat</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#voice-chat">Voice chat</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#mood">Mood Tracker</a>
                        </li>
                    </ul>
                    <button id="emergency-btn" class="btn btn-danger ms-auto" type="button" style="margin-left: auto;">
                        Emergency Alert
                    </button>
                </div>
            </div>
        </nav>
        <main class="">
            <section id="home" class="section">
                <div class="text-center py-5 bg-light rounded-3 mb-4">
                    <h2 class="display-4 mb-3">Welcome to Mentalyze üå±</h2>
                    <p class="lead">Your Compassionate AI Mental Health Companion</p>
                    <div class="d-grid gap-2 d-md-block mt-4">
                        <a href="#chat">
                            <button class="btn btn-primary btn-lg me-md-2" onclick="showView('chat')">
                                Start Talking Now üí¨
                            </button>
                        </a>
                        <a href="#assessment">
                            <button class="btn btn-outline-secondary btn-lg" onclick="showView('assessment')">
                                Take Quick Assessment üìù
                            </button>
                        </a>
                    </div>
                </div>
                <!-- Features Grid -->
                <div class="row g-4 mb-5">
                    <div class="col-md-6">
                        <div class="card  shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">üß† AI-Powered Insights</h5>
                                <p class="card-text">24/7 access to trauma-informed AI support with natural conversation
                                    flow</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">üìà Adaptive Assessments</h5>
                                <p class="card-text">Personalized 10-minute mental health evaluation with PDF report</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="card  shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">üìÖ Mood Tracking</h5>
                                <p class="card-text">Visualize emotional patterns with interactive charts & insights</p>
                                <button class="btn btn-outline-primary mt-2" onclick="showView('mood')">
                                    Track My Mood Now
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card  shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">üéôÔ∏è Voice Chat</h5>
                                <p class="card-text">Hands-free conversations with natural voice recognition</p>
                                <div class="mt-3">
                                    <span class="badge bg-info">Browser Supported</span>
                                    <span class="badge bg-warning text-dark">Chrome Recommended</span>
                                </div>
                                <button class="btn btn-outline-primary mt-2" onclick="showView('voice-chat')">
                                    Try Voice Mode
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Demo Preview -->
                <div class="row g-4 mb-5 ">
                    <div class="col-md-6">
                        <div class="p-4 border rounded-3 bg-white">
                            <h4 class="mb-3">See Mentalyze in Action</h4>
                            <div class="chat-preview border p-3 rounded">
                                <p class="user-msg mb-2">"I've been feeling overwhelmed at work..."</p>
                                <p class="ai-msg mb-0 text-muted">"Let's explore some grounding techniques together. üå∏"
                                </p>
                            </div>
                            <button class="btn btn-outline-primary mt-3" onclick="showView('chat')">
                                Try Live Chat Simulator
                            </button>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="p-4 border rounded-3 bg-white">
                            <h4 class="mb-3">Your Safety First üõ°Ô∏è</h4>
                            <p>Immediate access to crisis resources and emergency contacts</p>
                            <div class="alert alert-warning">
                                <strong>Need urgent help?</strong> Our emergency alert system connects you with
                                professionals
                                <button id="emergency-btn" class="btn btn-sm btn-danger mt-2">
                                    üö® Trigger Emergency Protocol
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <section id="model-comparison"
                    style="margin-top: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 8px; background-color: #f9f9f9;">
                    <h3>LLM Model Performance Comparison</h3>
                    <div id="model-comparison-content">
                        <p>Loading model benchmark data...</p>
                    </div>
                </section>
            </section>
            <section id="assessment" class="section">
                <h2>Mental Health Assessment</h2>
                <div id="assessment-description">
                    <p>This assessment helps you understand your mental well-being by answering a few simple questions.
                    </p>
                    <p>There are some questions to be answsered to get a overview of your mental state.</p>
                    <p>It provides insights into your mood, stress, sleep, loneliness, and concentration.</p>
                </div>
                <button id="start-assessment-btn">Start Assessment</button>
                <div id="assessment-progress" style="margin-top: 10px; font-weight: bold;"></div>
                <div id="assessment-questions"></div>
                <div id="assessment-navigation" class="content-between" style="margin-top: 10px;">
                    <button id="prev-question-btn" disabled>Previous</button>
                    <button id="next-question-btn" disabled>Next</button>
                </div>
            </section>
            <section id="chat" class="section">
                <div id="chat-messages"></div>
                <div class="sticky-bottom">
                    <input type="text" id="chat-input" placeholder="Type your message..." autocomplete="off"
                        autofocus />
                    <button id="send-btn">Send</button>
                </div>
            </section>
            <section id="voice-chat" class="section" style="display:none;">
                <h2>Voice Chat</h2>
                <button id="start-voice-chat-btn">Start Voice Chat</button>
                <div id="voice-chat-messages"
                    style="background: transparent; height: 100%; overflow-y: auto; margin-top: 10px; padding: 10px;">
                </div>
            </section>
            <section id="mood" class="section">
                <h2>Mood Tracker</h2>
                <button id="happy-btn">Happy</button>
                <button id="sad-btn">Sad</button>
                <button id="anxious-btn">Anxious</button>
                <div id="mood-feedback" class="w-auto" style="margin-top: 10px; font-weight: bold;"></div>
            </section>
        </main>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>
        // SocketIO client initialization
        const socket = io();

        // Voice Chat UI Elements
        const startVoiceChatBtn = document.getElementById('start-voice-chat-btn');
        const voiceChatMessages = document.getElementById('voice-chat-messages');

        // Voice Recognition Setup
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition;
        let recognizing = false;

        function appendVoiceChatMessage(sender, text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = marked.parse(text);
            voiceChatMessages.appendChild(messageDiv);
            voiceChatMessages.scrollTop = voiceChatMessages.scrollHeight;
        }

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onstart = () => {
                recognizing = true;
                startVoiceChatBtn.textContent = 'Listening... Click to Stop';
            };

            recognition.onend = () => {
                recognizing = false;
                startVoiceChatBtn.textContent = 'Start Voice Chat';
            };

            recognition.onerror = (event) => {
                console.error('Speech recognition error', event.error);
                appendVoiceChatMessage('ai', `‚ö†Ô∏è Speech recognition error: ${event.error}`);
            };

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                appendVoiceChatMessage('user', transcript);
                socket.emit('voice_message', transcript);
            };
        } else {
            startVoiceChatBtn.disabled = true;
            appendVoiceChatMessage('ai', '‚ö†Ô∏è Speech Recognition API not supported in this browser.');
        }

        startVoiceChatBtn.addEventListener('click', () => {
            if (recognizing) {
                recognition.stop();
                recognizing = false;
                startVoiceChatBtn.textContent = 'Start Voice Chat';
            } else {
                recognition.start();
            }
        });

        socket.on('bot_response', (msg) => {
            appendVoiceChatMessage('ai', msg);
        });


    </script>
    <script>
        // Function to show a specific view and hide others
        function showView(viewId) {
            const sections = ['home', 'assessment', 'chat', 'voice-chat', 'mood'];
            sections.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.style.display = (id === viewId) ? 'block' : 'none';
                }
            });
            // Scroll to top of the shown section
            const activeSection = document.getElementById(viewId);
            if (activeSection) {
                activeSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Initialize by showing home section only
        document.addEventListener('DOMContentLoaded', () => {
            showView('home');
        });

        // Emergency button handler
        function triggerEmergencyProtocol() {
            // Placeholder: Implement actual emergency protocol here
            alert('Emergency protocol triggered! Please stay calm and wait for assistance.');
        }

        // Attach event listeners to all emergency buttons
        document.querySelectorAll('#emergency-btn').forEach(button => {
            button.addEventListener('click', triggerEmergencyProtocol);
        });
    </script>
</body>

</html>